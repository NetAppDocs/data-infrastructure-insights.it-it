---
sidebar: sidebar 
permalink: task_config_telegraf_haproxy.html 
keywords: telegraf, installation, install, haproxy 
summary: Configurazione del raccoglitore dati HAProxy 
---
= Raccoglitore dati HAProxy
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Data Infrastructure Insights utilizza questo raccoglitore di dati per raccogliere metriche da HAProxy.



== Installazione

. Da *Osservabilità > Collettori*, fare clic su *+Collettore dati*.  Scegli HAProxy.
+
Selezionare il sistema operativo o la piattaforma su cui è installato l'agente Telegraf.

. Se non hai ancora installato un agente per la raccolta o desideri installare un agente per un sistema operativo o una piattaforma diversi, fai clic su _Mostra istruzioni_ per espandere lalink:task_config_telegraf_agent.html["Installazione dell'agente"] istruzioni.
. Selezionare la chiave di accesso dell'agente da utilizzare con questo raccoglitore dati.  È possibile aggiungere una nuova chiave di accesso agente facendo clic sul pulsante *+ Chiave di accesso agente*.  Procedura consigliata: utilizzare una chiave di accesso agente diversa solo quando si desidera raggruppare i raccoglitori di dati, ad esempio in base al sistema operativo/piattaforma.
. Seguire i passaggi di configurazione per configurare il raccoglitore dati.  Le istruzioni variano a seconda del tipo di sistema operativo o piattaforma utilizzata per raccogliere i dati.


image:HAProxyDCConfigLinux.png["Configurazione HAProxy"]



== Impostare

Il plugin di Telegraf per HAProxy si basa sull'abilitazione di HAProxy Stats.  Questa è una configurazione integrata in HAProxy, ma non è abilitata di default.  Se abilitato, HAProxy esporrà un endpoint HTML che può essere visualizzato sul browser o recuperato per l'estrazione dello stato di tutte le configurazioni HAProxy.



=== Compatibilità:

La configurazione è stata sviluppata per HAProxy versione 1.9.4.



=== Impostazione:

Per abilitare le statistiche, modifica il file di configurazione haproxy e aggiungi le seguenti righe dopo la sezione 'defaults', utilizzando il tuo nome utente/password e/o l'URL haproxy:

[listing]
----
stats enable
stats auth myuser:mypassword
stats uri  /haproxy?stats
----
Di seguito è riportato un esempio semplificato di file di configurazione con statistiche abilitate:

[listing]
----
global
  daemon
  maxconn 256

defaults
  mode http
  stats enable
  stats uri /haproxy?stats
  stats auth myuser:mypassword
  timeout connect 5000ms
  timeout client 50000ms
  timeout server 50000ms

frontend http-in
  bind *:80
  default_backend servers

frontend http-in9080
  bind *:9080
  default_backend servers_2

backend servers
  server server1 10.128.0.55:8080 check ssl verify none
  server server2 10.128.0.56:8080 check ssl verify none

backend servers_2
  server server3 10.128.0.57:8080 check ssl verify none
  server server4 10.128.0.58:8080 check ssl verify none
----
Per istruzioni complete e aggiornate, consultare illink:https://cbonte.github.io/haproxy-dconv/1.8/configuration.html#4-stats%20enable["Documentazione HAProxy"] .



== Oggetti e contatori

Vengono raccolti i seguenti oggetti e i relativi contatori:

[cols="<.<,<.<,<.<,<.<"]
|===
| Oggetto: | Identificatori: | Attributi: | Punti dati: 


| Frontend HAProxy | Proxy indirizzo spazio dei nomi | IP nodo Nome nodo ID proxy Modalità ID processo Sessioni Limite velocità ID server Limite sessioni Stato | Byte in entrata Byte in uscita Cache Hits Cache Lookups Compressione Byte bypassati Compressione Byte in entrata Compressione Byte in uscita Compressione Risposte Velocità di connessione Velocità di connessione Connessioni massime Totale richieste rifiutate dalla regola di connessione Richieste rifiutate per problemi di sicurezza Risposte rifiutate per problemi di sicurezza Richieste rifiutate dalla regola di sessione Richieste Errori Risposte Risposte 1xx Risposte 2xx Risposte 3xx Risposte 4xx Risposte 5xx Altre richieste Sessioni intercettate Velocità sessioni Velocità richieste massime Velocità richieste Velocità richieste massime Totale sessioni Sessioni Sessioni massime Totale richieste Riscritture 


| Server HAProxy | Server proxy indirizzo spazio dei nomi | IP del nodo Nome del nodo Controlla ora di fine Controlla configurazione caduta Controlla valore integrità Controlla configurazione salita Controlla stato ID proxy Ora ultima modifica Ora ultima sessione Modalità ID processo ID server Stato Peso | Server attivi Server di backup Byte in entrata Byte in uscita Controlli inattivi Controlli non riusciti Client interrompe Connessioni Tempo medio di connessione Tempo di inattività Totale risposte negate Errori di connessione Errori di risposta Risposte 1xx Risposte 2xx Risposte 3xx Risposte 4xx Risposte 5xx Altro server selezionato Coda totale Coda corrente Tempo medio massimo della coda Sessioni al secondo Sessioni al secondo Tempo massimo di riutilizzo della connessione Tempo di risposta Media sessioni Sessioni Massimo trasferimento server Interruzioni sessioni Totale sessioni Tempo medio totale Richieste Ridistribuzioni Richieste Nuovi tentativi Richieste Riscritture 


| Backend HAProxy | Proxy indirizzo spazio dei nomi | IP nodo Nome nodo ID proxy Ora ultima modifica Ora ultima sessione Modalità ID processo ID server Limite sessioni Stato Peso | Server attivi Server di backup Byte in entrata Byte in uscita Cache Hit Cache Lookup Check Down Client Abort Compressione Byte bypassati Compressione Byte in entrata Compressione Byte in uscita Compressione Risposte Connessioni Tempo medio di connessione Tempo di inattività Richieste totali negate per problemi di sicurezza Risposte negate per problemi di sicurezza Errori di connessione Errori di risposta Risposte 1xx Risposte 2xx Risposte 3xx Risposte 4xx Risposte 5xx Altro server selezionato Coda totale Coda corrente Coda massima Tempo medio Sessioni al secondo Sessioni al secondo Richieste massime Riutilizzo della connessione Tempo di risposta Media sessioni Sessioni Massima server Trasferimento Abort Sessioni Sessioni totali Tempo totale Richieste medie Ridistribuzioni Richieste Nuovi tentativi Richieste Riscritture 
|===


== Risoluzione dei problemi

Ulteriori informazioni possono essere trovate pressolink:concept_requesting_support.html["Supporto"] pagina.
